/* -----------------------
 * iFrame Auto Size Script
 * -----------------------
 * This script is used to create auto sizing iFrames, even if they are served from a different domain.
 * NB: This script needs to be loaded into the parent page AND the embedded page so you need access to include the script on the iFrame domain
 *
 * Usage: http://scripts.deependmelbourne.com.au/iFrameAutoSize.html
 * 
 * Author: Rick Lannan, Deepend
 * Version: 1.1
 * References: http://stackoverflow.com/questions/153152/resizing-an-iframe-based-on-content
 * Copyright (C): Rick Lannan, 2013 
 * Distibution & Modification: GNU License, please give credit
 */
var iFrameAutoSize={iFrameSettings:null,create:function(e){var t={domId:e&&e.domId?e.domId:"",iFrameUrl:e&&e.iFrameUrl?e.iFrameUrl:"",resizeHelperUrl:e&&e.resizeHelperUrl?e.resizeHelperUrl:"",loaderUrl:e&&e.loaderUrl?e.loaderUrl:"",waitForPageLoad:e&&e.waitForPageLoad?e.waitForPageLoad:false,adjustWidth:e&&e.adjustWidth?e.adjustWidth:false,initialWidth:e&&e.initialWidth?e.initialWidth:"100%",initialHeight:e&&e.initialHeight?e.initialHeight:"0px",additionalCSS:e&&e.additionalCSS?e.additionalCSS:"",onResize:e&&e.onResize?e.onResize:null};if(t.domId&&t.iFrameUrl&&t.resizeHelperUrl){t.resizeHelperUrl=t.resizeHelperUrl.replace(/^(https?:)?\/\//i,window.location.protocol+"//");if(t.resizeHelperUrl.indexOf("/")==0)t.resizeHelperUrl=window.location.protocol+"//"+window.location.host+t.resizeHelperUrl;if(t.resizeHelperUrl.indexOf("http")!=0)t.resizeHelperUrl=window.location.href.replace(/[^\/]*$/,"")+t.resizeHelperUrl;var n=document.getElementById(t.domId);if(n){if(!iFrameAutoSize.iFrameSettings)iFrameAutoSize.iFrameSettings=new Array;iFrameAutoSize.iFrameSettings[t.domId]={iFrame:null,loader:null,adjustWidth:false,onResize:null};var r=iFrameAutoSize.iFrameSettings[t.domId];function i(){if(t.adjustWidth)r.adjustWidth=t.adjustWidth;r.iFrame=document.getElementById("iFrameAutoSize-"+t.domId);if(t.onResize)r.onResize=t.onResize;if(!r.iFrame){r.iFrame=document.createElement("IFRAME");r.iFrame.style.width=t.initialWidth;r.iFrame.style.height=t.initialHeight;r.iFrame.style.border=0;r.iFrame.setAttribute("frameborder",0);r.iFrame.setAttribute("frameBorder",0);r.iFrame.setAttribute("border",0);r.iFrame.setAttribute("cellspacing",0);r.iFrame.setAttribute("marginwidth",0);r.iFrame.setAttribute("marginheight",0);r.iFrame.setAttribute("scrolling","no");r.iFrame.setAttribute("id","iFrameAutoSize-"+t.domId);n.appendChild(r.iFrame)}r.iFrame.setAttribute("src",t.iFrameUrl+(t.iFrameUrl.indexOf("?")==-1?"?":"&")+(t.resizeHelperUrl?"helperUrl="+encodeURIComponent(t.resizeHelperUrl):"")+"&parentDomId="+t.domId)}if(t.loaderUrl){r.loader=document.createElement("IMG");r.loader.setAttribute("src",t.loaderUrl);r.loader.style.display="block";r.loader.style.margin="0 auto";r.loader.setAttribute("id","iFrameAutoSize-"+t.domId+"-loader");r.loader.setAttribute("class","iFrameAutoSize-loader");n.appendChild(r.loader)}if(t.waitForPageLoad){iFrameAutoSize.helpers.addDomEvent(window,"load",i)}else{i()}}}},forceParentFrame:function(e){var t={parentUrl:e&&e.parentUrl?e.parentUrl:""};if(t.parentUrl&&window.self===window.top){window.location.href=t.parentUrl+(t.parentUrl.indexOf("?")==-1?"?":"&")+"frameUrl="+encodeURIComponent(window.location.href)}},resize:function(e){var t={resizeHelperUrl:e&&e.resizeHelperUrl?e.resizeHelperUrl:"",domId:e&&e.domId?e.domId:"",parentDomId:e&&e.parentDomId?e.parentDomId:"",resizeOnLoadOnly:e&&e.resizeOnLoadOnly?e.resizeOnLoadOnly:false,waitForPageLoad:e&&e.waitForPageLoad?e.waitForPageLoad:false,useCookie:e&&e.useCookie?e.useCookie:true};if(!t.resizeHelperUrl){t.resizeHelperUrl=decodeURIComponent(iFrameAutoSize.helpers.getQueryStringParam(window.location.search,"helperUrl"))}if(t.useCookie&&!t.resizeHelperUrl){t.resizeHelperUrl=iFrameAutoSize.helpers.getCookie("iFrameAutoSize_helperUrl")}if(!t.parentDomId){t.parentDomId=decodeURIComponent(iFrameAutoSize.helpers.getQueryStringParam(window.location.search,"parentDomId"))}if(t.useCookie&&!t.parentDomId){t.parentDomId=iFrameAutoSize.helpers.getCookie("iFrameAutoSize_parentDomId")}if(t.resizeHelperUrl&&t.parentDomId){if(t.useCookie){iFrameAutoSize.helpers.setCookie("iFrameAutoSize_helperUrl",t.resizeHelperUrl);iFrameAutoSize.helpers.setCookie("iFrameAutoSize_parentDomId",t.parentDomId)}function n(){var e=iFrameAutoSize.helpers.getPageDimensions();if(t.domId){e=iFrameAutoSize.helpers.getDimensions(t.domId)}var r=document.getElementById("iFrameAutoSizePipe");if(!r){r=document.createElement("IFRAME");r.style.width=0;r.style.height=0;r.setAttribute("frameborder",0);r.setAttribute("id","iFrameAutoSizePipe");r.setAttribute("visibility","hidden");document.body.appendChild(r)}if(!iFrameAutoSize.iFrameSettings){iFrameAutoSize.iFrameSettings={currHeight:0,currWidth:0,sizeAdjusted:false,frameLoaded:false}}var i=iFrameAutoSize.iFrameSettings;if(e.height!=i.currHeight||e.width!=i.currWidth){i.currWidth=e.width;i.currHeight=i.frameLoaded?e.height:0;if(!i.sizeAdjusted){r.setAttribute("src",t.resizeHelperUrl+"?domId="+t.parentDomId+"&height="+i.currHeight+"&width="+i.currWidth+"&cacheb="+Math.random())}if(!i.frameLoaded){i.frameLoaded=true}else{i.sizeAdjusted=true}}else{i.sizeAdjusted=false}if(!t.resizeOnLoadOnly||!i.frameLoaded)setTimeout(n,100)}if(t.waitForPageLoad){iFrameAutoSize.helpers.addDomEvent(window,"load",n)}else{n()}}},helpers:{resizeIFrame:function(e,t,n){var r=iFrameAutoSize.iFrameSettings[e];if(r&&r.iFrame){r.iFrame.style.height=parseInt(n)+"px";if(r.adjustWidth){r.iFrame.style.width=parseInt(t)+"px"}else{r.iFrame.style.width="100%"}if(typeof r.onResize=="function"){r.onResize.apply(r.iFrame)}if(r.loader&&n>1){r.loader.style.display="none"}}},addDomEvent:function(e,t,n){if(e==null||e==undefined)return;if(e.addEventListener){e.addEventListener(t,n,false)}else if(e.attachEvent){e.attachEvent("on"+t,n)}else{e["on"+t]=n}},getPageDimensions:function(){var e=document;return{width:Math.max(Math.max(e.body.scrollWidth,e.documentElement.scrollWidth),Math.max(e.body.offsetWidth,e.documentElement.offsetWidth),Math.max(e.body.clientWidth,e.documentElement.clientWidth)),height:Math.max(Math.max(e.body.scrollHeight,e.documentElement.scrollHeight),Math.max(e.body.offsetHeight,e.documentElement.offsetHeight),Math.max(e.body.clientHeight,e.documentElement.clientHeight))}},getDimensions:function(e){var t=document.getElementById(e);if(t){return{width:Math.max(Math.max(t.scrollWidth,t.offsetWidth),t.clientWidth),height:Math.max(Math.max(t.scrollHeight,t.offsetHeight),t.clientHeight)}}else{return getPageDimensions()}},setCookie:function(e,t){document.cookie=e+"="+escape(t)},getCookie:function(e){e=e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");var t="(^|[;,\\s])"+e+"\\s?=\\s?([^;,\\s]*)";var n=new RegExp(t);var r=n.exec(document.cookie);if(r==null){return""}else{return unescape(r[2])}},getQueryStringParam:function(e,t){t=t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");var n="[\\?&]"+t+"=([^&#]*)";var r=new RegExp(n);var i=r.exec(e);if(i==null){return""}else{return i[1]}}}};